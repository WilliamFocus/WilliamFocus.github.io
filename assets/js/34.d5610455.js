(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{612:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"_1、特殊情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、特殊情况"}},[s._v("#")]),s._v(" 1、特殊情况")]),s._v(" "),a("p",[a("strong",[s._v("（注意：仅项目开发重构逃生舱，不推荐使用，所有绕过静态类型检测的方法都是魔鬼！！！）")])]),s._v(" "),a("div",{staticClass:"language-tsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @ts-nocheck 禁用整个文件的ts校验")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @ts-ignore 禁用单行ts校验")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @ts-expect-error 标记代码中表示下一行应当有类型错误 (编写预期失败的单元测试中使用)")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"_2、tsconfig-json-配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、tsconfig-json-配置文件"}},[s._v("#")]),s._v(" 2、tsconfig.json 配置文件")]),s._v(" "),a("ul",[a("li",[s._v("compilerOptions 配置\n"),a("strong",[s._v("项目选项")]),s._v(" "),a("ul",[a("li",[s._v("target：指定 TypeScript 编译代码的目标 JS 版本，默认 ES3；")]),s._v(" "),a("li",[s._v("module：设置 TS 代码使用的模块化系统，ES6 之前 CommonJS，ES6 之后默认 ES6；")]),s._v(" "),a("li",[s._v("jsx：控制 jsx 文件的转译输出方式，只影响"),a("code",[s._v(".tsx")]),s._v("文件；\n''react'': 将 jsx 改为等价的对 React.createElement 的调用，并生成.js 文件")]),s._v(" "),a("li",[s._v("incremental：是否启用增量编译；")]),s._v(" "),a("li",[s._v("declaration：是否为项目的 TS 或 JS 文件生成"),a("code",[s._v(".d.ts")]),s._v("类型声明文件；")]),s._v(" "),a("li",[s._v("sourceMap：是否生成映射文件使用调试 JS 时显示 TS 代码；")]),s._v(" "),a("li",[s._v("lib：自定义控制代码运行时的类型库定义文件；\n(如果 lib 参数缺省，则默认包含了 DOM 类型；如果显式设置了 lib 参数，那么一定要添加 DOM)\n(TypeScript > lib，详见"),a("a",{attrs:{href:"https://github.com/microsoft/TypeScript/tree/main/lib",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/microsoft/TypeScript/tree/main/lib"),a("OutboundLink")],1),s._v(")")]),s._v(" "),a("li",[s._v("allowJs：允许 JavaScript 和 TypeScript 混用；\n"),a("strong",[s._v("严格模式")])]),s._v(" "),a("li",[s._v("strict：是否开启严格模式**（推荐）**")]),s._v(" "),a("li",[s._v("alwaysStrict：开启 ECMAScript 严格模式，每个编译出来的文件头部添加 use strict")]),s._v(" "),a("li",[s._v("strictNullChecks：严格检查 Null 和 undefined 类型出现的地方")]),s._v(" "),a("li",[s._v("strictBindCallApply：严格检查 call、bind、apply 函数的调用")]),s._v(" "),a("li",[s._v("strictFunctionTypes：严格检查函数参数类型和兼容性；")]),s._v(" "),a("li",[s._v("strictPropertyInitialization：严格检查类属性初始化；")]),s._v(" "),a("li",[s._v("noImplicitAny：禁止出现隐式 any 类型，需要显式指定类型")]),s._v(" "),a("li",[s._v("noImplicitThis：禁止隐式 this 类型，需要显示指定 this 的类型\n"),a("strong",[s._v("额外检查（或使用 ESLint）")])]),s._v(" "),a("li",[s._v("noImplicitReturns：禁止隐式返回值，若有返回则必须所有分支都返回；")]),s._v(" "),a("li",[s._v("noUnusedLocals：禁止出现未使用本地变量")]),s._v(" "),a("li",[s._v("noUnusedParameters：Switch 语句必须出现 break 或者 return\n"),a("strong",[s._v("模块解析配置")])]),s._v(" "),a("li",[s._v("moduleResolution：模块解析策略，默认为 classic，否则为 node（一般）")]),s._v(" "),a("li",[s._v("baseUrl：TS 解析非绝对路径模块名的基准路径，"),a("code",[s._v("./")]),s._v(" 相对于 tsconfig.json 开始查找")]),s._v(" "),a("li",[s._v("paths：将模块路径重新映射到相对于 baseUrl 定位的其他路径配置，即起别名："),a("div",{staticClass:"language-tsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"compilerOptions"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"paths"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t     "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"@/*"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src/*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 使TS解析支持以自定义前缀寻找模块")]),s._v("\n\t     "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"@@/*"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src/.umi/*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// paths 中配置的别名仅在 类型检测 时生效")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])]),s._v(" "),a("li",[s._v("rootDirs：指定多个目录为根目录，虚拟根目录将视为合并到同一目录下")]),s._v(" "),a("li",[s._v("typeRoots：指定类型文件根目录，从指定目录下查找类型文件，默认 node_modules/@types 下")]),s._v(" "),a("li",[s._v("types：手动指定编译过程需要的模块包文件，默认 typeRoots 的包")]),s._v(" "),a("li",[s._v("allowSyntheticDefaultImports：允许合成默认导出，即无默认导出也可以使用默认导入方式")]),s._v(" "),a("li",[s._v("esModuleInterop：解决 TS 代码转移导致的不符合 ES6 模块化规范，一般配合 allowSyntheticDefaultImports 开启使用；\n"),a("strong",[s._v("Source Maps 附加文件（.map 文件）")])]),s._v(" "),a("li",[s._v("sourceRoot：调试器需要定位的 TS 文件位置路径")]),s._v(" "),a("li",[s._v("mapRoot：指定调试器定位的 source map 文件的位置")]),s._v(" "),a("li",[s._v("inlineSourceMap：将 source map 文件内容生成内联字符串写入对应的"),a("code",[s._v(".js")]),s._v("文件中")]),s._v(" "),a("li",[s._v("inlineSources：将源文件的所有内容生成内联字符串并写入 source map 中\n"),a("strong",[s._v("实验性配置")])]),s._v(" "),a("li",[s._v("experimentalDecorators：开启装饰器特性（JS 装饰器提案目前处于 stage 2）")]),s._v(" "),a("li",[s._v("emitDecoratorMetadata：装饰器使用反射数据特性\n"),a("strong",[s._v("高级选项")])]),s._v(" "),a("li",[s._v("skipLibCheck：跳过检查类型声明文件，可以节省 TS 编译时间")]),s._v(" "),a("li",[s._v("forceConsistentCasingInFileNames：是否开启校验文件大小写敏感需与系统规则一致")]),s._v(" "),a("li",[s._v('include：指定需要包括在 TypeScript 项目中的文件或者文件匹配路径，指定了 files 配置项，则默认值为 []，否则 include 默认值为 ["**/*"]\n一般来说，include 的默认值为'),a("code",[s._v(".ts")]),s._v("、"),a("code",[s._v(".tsx")]),s._v(" 和 "),a("code",[s._v(".d.ts")]),s._v("。如果我们开启了 "),a("code",[s._v("allowJs")]),s._v(" 选项，还包括"),a("code",[s._v(".js")]),s._v("和"),a("code",[s._v(".jsx")]),s._v("文件")]),s._v(" "),a("li",[s._v("exclude：指定解析 include 配置中需要跳过的文件或者文件匹配路径")]),s._v(" "),a("li",[s._v("files：指定 TypeScript 项目中需要包含的文件列表")]),s._v(" "),a("li",[s._v("extends：声明当前配置需要继承的另外一个配置的路径，首先会加载 extends 的配置文件，然后使用当前的 tsconfig.json 的文件覆盖继承文件的配置")])])])]),s._v(" "),a("h2",{attrs:{id:"_3、ts-开发实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、ts-开发实践"}},[s._v("#")]),s._v(" 3、TS 开发实践")]),s._v(" "),a("ul",[a("li",[s._v("npm 模块开发目录结构"),a("div",{staticClass:"language-tsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("build   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Web 项目的构建产物")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lib   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Node.js 模块的构建产物，转译工具自动创建放 JavaScript 代码的目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("__test__   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 单元测试文件目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("src   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 放 TypeScript 源码的目录")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ts   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CLI 命令入口文件")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("serve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ts   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CLI 命令入口文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("typings   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 组织类型声明定义")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])]),s._v(" "),a("li",[s._v("原生 DOM 元素类型\n"),a("code",[s._v("HTMLElement")]),s._v(" 、"),a("code",[s._v("HTMLUListElement")]),s._v("、"),a("code",[s._v("HTMLButtonElement......")])]),s._v(" "),a("li",[s._v("主流框架 React\n"),a("ol",[a("li",[s._v("**Service 类型化：**将项目中的请求接口参数和返回值进行类型检查和代码提示，前后端同一接口格式规范，使用 Swagger、YAPI、GraphQL 自动生成 TypeScript 接口调用代码；")]),s._v(" "),a("li",[a("strong",[s._v("Component 类型化：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("类式组件：")]),a("code",[s._v("React.Component")]),s._v(" 和 "),a("code",[s._v("React.PureComponent")]),s._v(" 基类；")]),s._v(" "),a("li",[a("strong",[s._v("函数组件：")]),a("code",[s._v("React.FunctionComponent")]),s._v("（或简写为 "),a("code",[s._v("React.FC")]),s._v("），对于编写函数组件而言，显式注解类型是一个好的实践；"),a("div",{staticClass:"language-tsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 任意组件类型")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ComponentType"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("P")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ComponentClass"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("P")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" FunctionComponent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("P")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 元素类型")]),s._v("\nReact"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ElementType\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 元素节点类型")]),s._v("\nReact"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ReactElement\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 节点类型")]),s._v("\nReact"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ReactNode\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// JSX 元素类型")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSX")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Element "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ReactElement"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("any")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("any")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])]),s._v(" "),a("li",[a("strong",[s._v("高阶组件类型")]),a("div",{staticClass:"language-tsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IHOCProps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  injectId"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("number")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOwnProps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  ownId"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("number")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" hoc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("C")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("React")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ComponentType"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("any")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("C")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" cp\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" InjectedCp1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hoc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("OriginalCp "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ComponentType"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("IOwnProps"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" InjectedCp2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hoc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  OriginalCp "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ComponentType"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("\n    Omit"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("IHOCProps "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" IOwnProps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'injectId'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])])]),s._v(" "),a("li",[a("strong",[s._v("路由组件类型：")]),s._v(" "),a("code",[s._v("import { RouteComponentProps } from 'react-router-dom';")])]),s._v(" "),a("li",[s._v("**Redux 类型化：**Redux 类型化涉及 "),a("code",[s._v("state")]),s._v("、"),a("code",[s._v("action")]),s._v("、"),a("code",[s._v("reducer")]),s._v(" 三要素类型化，因为分别类型化三要素的形式写起来十分复杂，所以可以借助 "),a("code",[s._v("typesafe-actions")]),s._v("、"),a("code",[s._v("redux-actions")]),s._v("、"),a("code",[s._v("rematch")]),s._v("、"),a("code",[s._v("dvajs")]),s._v("、"),a("code",[s._v("@ekit/model")]),s._v(" 等工具更清晰、高效地组织 Redux 代码；"),a("div",{staticClass:"language-tsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// TS4.1 模板字面量类型")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrefixType"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("P")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("N")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("P")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("Capitalize"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("N")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserLoginAction")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PrefixType"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'User'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'login'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 'User/Login'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])])])])])]),s._v(" "),a("li",[s._v("使用单元测试\n可以选择 "),a("code",[s._v("Jest + Enzyme + jsdom + ReactTestUtils")]),s._v(" 作为 React + TypeScript 应用的单元测试技术方案，不过麻烦的地方在于需要手动配置 Jest、Enzyme。因此更推荐选择"),a("code",[s._v("react-testing-library")]),s._v("这个方案，这也是 create-react-app 项目默认内置的单元测试方案。")])]),s._v(" "),a("h2",{attrs:{id:"_4、js-项目迁移-ts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、js-项目迁移-ts"}},[s._v("#")]),s._v(" 4、JS 项目迁移 TS")]),s._v(" "),a("ul",[a("li",[s._v("步骤技巧\n"),a("ol",[a("li",[s._v("配置好 tsconfig.json，尽可能少改动源码，关闭 TS 严格模式，尽量宽松地配置 TS；")]),s._v(" "),a("li",[s._v("Web 项目中不会直接使用 tsc 转译 TypeScript，因此需结合构建工具集成 TypeScript，如配置 webpack：\n"),a("ul",[a("li",[s._v("使用 ts-loader：可以开启 ts-loader 的 transpileOnly: true 配置，关闭 ts 转译时类型检测以提速，并可以在生产构建时使用 fork-ts-checker-webpack-plugin 插件配置代替静态类型检测；")]),s._v(" "),a("li",[s._v("使用 babel-loader：（需 babel-loader 的版本 >7）\n"),a("code",[s._v("npm i -D @babel/preset-typescript")]),s._v(" "),a("code",[s._v("['@babel/preset-typescript', { allowNamespaces: true }]")])])])]),s._v(" "),a("li",[s._v("迁移代码\n"),a("ul",[a("li",[s._v("补齐类型注解，添加类型声明文件("),a("code",[s._v(".d.ts")]),s._v(")")]),s._v(" "),a("li",[s._v("去除隐式 any，全局类型 AnyToFix 来代替 any"),a("div",{staticClass:"language-tsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** 需要替换成更明确的类型 */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AnyToFix")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("any")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[s._v("使用自动迁移工具：可以使用 Airebnb 开源迁移工具"),a("code",[s._v("ts-migrate")]),s._v("加速迁移；")])])])])])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"_5、ts-一些新特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、ts-一些新特性"}},[s._v("#")]),s._v(" 5、TS 一些新特性")]),s._v(" "),a("p",[s._v("4.0 可变元组，可以对泛型使用展开运算符；")]),s._v(" "),a("p",[s._v("4.0 元组元素标签，可以给元组类型的定义中给类型元素指定标签；")]),s._v(" "),a("p",[s._v("4.1 模板字面量类型，")]),s._v(" "),a("p",[s._v("4.1 映射类型键名重新映射，可以理解为针对类型的类型断言")]),s._v(" "),a("div",{staticClass:"language-tsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Getters")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("K")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keyof")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("T")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("get")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("Capitalize"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("K")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("T")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserInfoGetters")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Getters"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("number")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 返回值类型{ getId: number; getName: string; }")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("4.2 元组头部/中间剩余元素，可以在元组类型的任何地方使用剩余元素("),a("code",[s._v("...T")]),s._v(")表达式，不再仅局限于元组的尾部；")]),s._v(" "),a("p",[s._v("4.2 yield 表达式会提示 noImplicitAny 错误，必须显式注解 yield 表达式的返回值类型，否则会提示错误，有助于使用 Redux-saga 管理副作用的 Redux 类型化方案，需补全缺失的返回值类型；")]),s._v(" "),a("p",[s._v("更多参考 TS 更新日志")]),s._v(" "),a("hr"),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",[s._v("💡 TypeScript 总结：")]),s._v(" "),a("p",[s._v("所有的变更都是朝着愈发严格而全面的类型安全目标演进的\n因此应该启用严格模式，以追求最高标准，养成好习惯")]),s._v(" "),a("p",[s._v("——END")])]),s._v(" "),a("p",[s._v("（——学习知识要善于思考，思考，再思考。—爱因斯坦）")])])}),[],!1,null,null,null);t.default=e.exports}}]);